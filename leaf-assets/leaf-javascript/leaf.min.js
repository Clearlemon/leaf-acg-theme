//禁用前台的global
var styleTag = document.getElementById('global-styles-inline-css');
if (styleTag) {
  styleTag.parentNode.removeChild(styleTag);
}

//3D标签云随机颜色
if ($(".leaf_link_tag").length) {
  var leafSpans = document.querySelectorAll('.leaf_link_tag');
  for (var i = 0; i < leafSpans.length; i++) {
    var randomColor = getRandomColor(); // 获取随机颜色
    leafSpans[i].style.backgroundColor = randomColor;
    leafSpans[i].style.opacity = getRandomOpacity(); // 获取随机透明度
  }

  // 生成随机颜色的函数
  function getRandomColor() {
    var letters = '0123456789ABCDEF';
    var color = '#';
    for (var i = 0; i < 6; i++) {
      color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
  }
}
// 生成随机透明度的函数
function getRandomOpacity() {
  return (Math.random() * (0.9 - 0.5) + 0.5).toFixed(2);
}
//一言
if ($("#sp-one-word ").length) {
  if (window.location.protocol === "https:") {
    var url = "https://" + window.location.hostname;
  } else {
    var url = "http://" + window.location.hostname;
  }

  url += "/wp-content/themes/leaf-acg-theme/leaf-api/leaf-one-word-api/summer-pockets-word/summer-pockets-word.php";

  $.ajax({
    url: url,
    dataType: "text",
    success: function (data) {
      // data 就是一言内容，可以通过 DOM 操作将其输出到页面上
      $("#sp-one-word").text(data);
    },
    error: function () {
      // 处理错误
      console.log("Failed to get hitokoto.");
    }
  });
} else if ($("#ab-one-word").length) {
  if (window.location.protocol === "https:") {
    var url = "https://" + window.location.hostname;
  } else {
    var url = "http://" + window.location.hostname;
  }

  url += "/wp-content/themes/leaf-acg-theme/leaf-api/leaf-one-word-api/angel-beats-word/angel-beats-word.php";

  $.ajax({
    url: url,
    dataType: "text",
    success: function (data) {
      // data 就是一言内容，可以通过 DOM 操作将其输出到页面上
      $("#ab-one-word").text(data);
    },
    error: function () {
      // 处理错误
      console.log("Failed to get hitokoto.");
    }
  });
} else if ($("#air-one-word").length) {
  if (window.location.protocol === "https:") {
    var url = "https://" + window.location.hostname;
  } else {
    var url = "http://" + window.location.hostname;
  }

  url += "/wp-content/themes/leaf-acg-theme/leaf-api/leaf-one-word-api/air-word/air-word.php";

  $.ajax({
    url: url,
    dataType: "text",
    success: function (data) {
      // data 就是一言内容，可以通过 DOM 操作将其输出到页面上
      $("#air-one-word").text(data);
    },
    error: function () {
      // 处理错误
      console.log("Failed to get hitokoto.");
    }
  });
} else if ($("#cl-one-word").length) {
  if (window.location.protocol === "https:") {
    var url = "https://" + window.location.hostname;
  } else {
    var url = "http://" + window.location.hostname;
  }

  url += "/wp-content/themes/leaf-acg-theme/leaf-api/leaf-one-word-api/clannad-word/clannad-word.php";

  $.ajax({
    url: url,
    dataType: "text",
    success: function (data) {
      // data 就是一言内容，可以通过 DOM 操作将其输出到页面上
      $("#cl-one-word").text(data);
    },
    error: function () {
      // 处理错误
      console.log("Failed to get hitokoto.");
    }
  });
} else if ($("#kanon-one-word").length) {
  if (window.location.protocol === "https:") {
    var url = "https://" + window.location.hostname;
  } else {
    var url = "http://" + window.location.hostname;
  }

  url += "/wp-content/themes/leaf-acg-theme/leaf-api/leaf-one-word-api/kanon-word/kanon-word.php";

  $.ajax({
    url: url,
    dataType: "text",
    success: function (data) {
      // data 就是一言内容，可以通过 DOM 操作将其输出到页面上
      $("#kanon-one-word").text(data);
    },
    error: function () {
      // 处理错误
      console.log("Failed to get hitokoto.");
    }
  });
}

//导航栏的侧边栏展开收缩
const sidebar = document.querySelector('.leaf_sidebar_nav_shrink');
const mainSidebar = document.querySelector('.leaf_sidebar_nav');
const closeBtn = document.querySelector('.leaf_sidebar_nav_black');

// 切换侧边栏展开/折叠状态
function toggleSidebar() {
  sidebar.classList.toggle('leaf_sidebar_nav_unfold');
}

// 关闭侧边栏搜索
function closeSidebar() {
  sidebar.classList.remove('leaf_sidebar_nav_unfold');
}

// 添加点击事件监听
mainSidebar.addEventListener('click', toggleSidebar);
closeBtn.addEventListener('click', closeSidebar);

//搜素框弹出
const search = document.querySelector('.leaf_search_eject_block_all_shrink');
const mainSearch = document.querySelector('.leaf_pop_up_search');
const searchBtn = document.querySelector('.leaf_search_mobile_black');

//弹出
function toggleSearch() {
  search.classList.toggle('leaf_search_block_unfold');
}

//隐藏
function closeSearch() {
  search.classList.remove('leaf_search_block_unfold');
}


// 添加点击事件监听
mainSearch.addEventListener('click', toggleSearch);
searchBtn.addEventListener('click', closeSearch);


//侧边栏菜单子菜单显现
document.addEventListener('DOMContentLoaded', function () {
  const aliDivs = document.querySelectorAll('.leaf_sidebar_ico_ali');
  let secondSubMenu; // 在循环外部定义变量

  aliDivs.forEach(function (aliDiv) {
    aliDiv.addEventListener('click', function () {
      const parentLi = this.closest('li');
      const subMenu = parentLi.querySelector('ul');

      if (parentLi.classList.contains('leaf_first_menu_sidebar')) {
        secondSubMenu = parentLi.querySelector('.leaf_second_menu_sidebar_ul'); // 在条件满足时赋值
        if (secondSubMenu) {
          secondSubMenu.classList.toggle('show-submenu');
        }
      } else if (parentLi.classList.contains('leaf_second_menu_sidebar')) {
        if (subMenu) {
          subMenu.classList.toggle('show-submenu');
        }
      }

      // Hide other submenus
      const otherSubMenus = document.querySelectorAll('.leaf_second_menu_sidebar_ul.show-submenu, .leaf_third_menu_sidebar_ul.show-submenu');
      otherSubMenus.forEach(function (otherSubMenu) {
        if (otherSubMenu !== subMenu && otherSubMenu !== secondSubMenu) {
          otherSubMenu.classList.remove('show-submenu');
        }
      });
    });
  });
});



